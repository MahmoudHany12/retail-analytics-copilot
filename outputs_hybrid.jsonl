{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "", "confidence": 0.6, "explanation": "Computed scalar value from 0 database rows.", "citations": ["product_policy::chunk0", "marketing_calendar::chunk1", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "hybrid_top_category_qty_summer_1997", "final_answer": {"category": "Confections", "quantity": 17372}, "sql": "SELECT c.CategoryName as category, SUM(od.Quantity) as quantity FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30' GROUP BY c.CategoryID ORDER BY quantity DESC LIMIT 1;", "confidence": 0.99, "explanation": "Retrieved object with fields: category, quantity.", "citations": ["Categories", "Order Details", "Orders", "Products", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "hybrid_aov_winter_1997", "final_answer": 21032.34, "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2017-12-01' AND '2017-12-31';", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Order Details", "Orders", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "Côte de Blaye", "revenue": 53265895.23}, {"product": "Thüringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "hybrid_revenue_beverages_summer_1997", "final_answer": 17372.0, "sql": "SELECT c.CategoryName as category, SUM(od.Quantity) as quantity FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30' GROUP BY c.CategoryID ORDER BY quantity DESC LIMIT 1;", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "hybrid_best_customer_margin_1997", "final_answer": {"customer": "Great Lakes Food Market", "margin": 238454.4}, "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '2013' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.99, "explanation": "Retrieved object with fields: customer, margin.", "citations": ["Customers", "Order Details", "Orders", "kpi_definitions::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_rag_beverage_return_policy_opened", "final_answer": "﻿# Returns & Policy\n- Perishables (Produce, Seafood, Dairy): 3–7 days.\n- Beverages unopened: 14 days; opened: no returns.\n- Non-perishables: 30 days. ## Summer Beverages 1997\n- Dates: 1997-06-01 to 1997-06-30\n- Notes: Focus on Beverages and Condiments. ﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ﻿# KPI Definitions\n## Average Order Value (AOV) ## Gr", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["product_policy::chunk0", "marketing_calendar::chunk1", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_rag_beverage_storage_temp", "final_answer": "﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ## Summer Beverages 1997\n- Dates: 1997-06-01 to 1997-06-30\n- Notes: Focus on Beverages and Condiments. ﻿# Returns & Policy\n- Perishables (Produce, Seafood, Dairy): 3–7 days.\n- Beverages unopened: 14 days; opened: no returns.\n- Non-perishables: 30 days. ﻿# KPI Definitions\n## Average Order Value (AOV) ## Gr", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["catalog::chunk0", "marketing_calendar::chunk1", "product_policy::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_rag_marketing_summer_promo_text", "final_answer": [{"revenue": 590780.5}], "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' AND o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2", "product_policy::chunk0"]}
{"id": "train_rag_kpi_aov_definition", "final_answer": [{"aov": 27538.79}], "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID ;", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_rag_return_days_unopened_beverages", "final_answer": 14, "sql": "", "confidence": 0.6, "explanation": "Computed scalar value from 0 database rows.", "citations": ["product_policy::chunk0", "marketing_calendar::chunk1", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_rag_catalog_note_condiments", "final_answer": [{"product": "Côte de Blaye", "revenue": 53265895.23}, {"product": "Thüringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk1"]}
{"id": "train_rag_policy_repackaging_allowed", "final_answer": "﻿# Returns & Policy\n- Perishables (Produce, Seafood, Dairy): 3–7 days.\n- Beverages unopened: 14 days; opened: no returns.\n- Non-perishables: 30 days. ## Winter Classics 1997\n- Dates: 1997-12-01 to 1997-12-31\n- Notes: Push Dairy Products and Confections for holiday gifting. ﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ﻿# KPI Definitions\n## Average Or", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["product_policy::chunk0", "marketing_calendar::chunk2", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_rag_promotions_winter_classics", "final_answer": [{"aov": 21032.34}], "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2017-12-01' AND '2017-12-31';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_rag_catalog_produce_handling", "final_answer": "﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ﻿# Returns & Policy\n- Perishables (Produce, Seafood, Dairy): 3–7 days.\n- Beverages unopened: 14 days; opened: no returns.\n- Non-perishables: 30 days. - AOV = SUM(UnitPrice * Quantity * (1 - Discount)) / COUNT(DISTINCT OrderID) ﻿# KPI Definitions\n## Average Order Value (AOV) ## Gross Margin\n- GM = SUM((Uni", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["catalog::chunk0", "product_policy::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_rag_kpi_margin_definition", "final_answer": [], "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '1997' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_rag_policy_return_restrictions", "final_answer": "﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ﻿# Returns & Policy\n- Perishables (Produce, Seafood, Dairy): 3–7 days.\n- Beverages unopened: 14 days; opened: no returns.\n- Non-perishables: 30 days. - AOV = SUM(UnitPrice * Quantity * (1 - Discount)) / COUNT(DISTINCT OrderID) ﻿# KPI Definitions\n## Average Order Value (AOV) ## Gross Margin\n- GM = SUM((Uni", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["catalog::chunk0", "product_policy::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_rag_catalog_seafood_storage", "final_answer": "﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ﻿# Returns & Policy\n- Perishables (Produce, Seafood, Dairy): 3–7 days.\n- Beverages unopened: 14 days; opened: no returns.\n- Non-perishables: 30 days. - AOV = SUM(UnitPrice * Quantity * (1 - Discount)) / COUNT(DISTINCT OrderID) ﻿# KPI Definitions\n## Average Order Value (AOV) ## Gross Margin\n- GM = SUM((Uni", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["catalog::chunk0", "product_policy::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_rag_marketing_promo_dates", "final_answer": "﻿# Northwind Marketing Calendar (1997) ## Summer Beverages 1997\n- Dates: 1997-06-01 to 1997-06-30\n- Notes: Focus on Beverages and Condiments. ## Winter Classics 1997\n- Dates: 1997-12-01 to 1997-12-31\n- Notes: Push Dairy Products and Confections for holiday gifting. ﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ﻿# Returns & Policy\n- Perishables (Produ", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2", "catalog::chunk0", "product_policy::chunk0"]}
{"id": "train_sql_top3_products_category_alltime", "final_answer": [{"product": "Côte de Blaye", "revenue": 53265895.23}, {"product": "Thüringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_top_suppliers_by_revenue", "final_answer": [{"supplier": "", "revenue": 53265895.23}, {"supplier": "", "revenue": 24623469.23}, {"supplier": "", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_sql_customers_most_orders", "final_answer": [{"customer": "", "orders": 0}, {"customer": "", "orders": 0}, {"customer": "", "orders": 0}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_sql_products_with_low_stock", "final_answer": [{"product": "Côte de Blaye", "units": 0}, {"product": "Thüringer Rostbratwurst", "units": 0}, {"product": "Mishi Kobe Niku", "units": 0}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_top3_products_by_profit_est", "final_answer": [{"product": "Côte de Blaye", "profit": 0.0}, {"product": "Thüringer Rostbratwurst", "profit": 0.0}, {"product": "Mishi Kobe Niku", "profit": 0.0}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_sales_by_category_year", "final_answer": [{"category": "", "revenue": 53265895.23}, {"category": "", "revenue": 24623469.23}, {"category": "", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_sql_customer_lifetime_value", "final_answer": {"customer": "", "ltv": 0.0}, "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Retrieved object with fields: customer, ltv.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_sql_products_with_high_discount", "final_answer": [{"product": "", "avg_discount": 0.0}], "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_suppliers_multiple_categories", "final_answer": [], "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '1997' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_orders_having_many_items", "final_answer": [{"order_id": 0, "product_count": 0}], "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_top_products_by_quantity_month", "final_answer": [], "sql": "SELECT c.CategoryName as category, SUM(od.Quantity) as quantity FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31' GROUP BY c.CategoryID ORDER BY quantity DESC LIMIT 1;", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_supplier_category_revenue", "final_answer": [{"supplier": "", "category": "", "revenue": 53265895.23}, {"supplier": "", "category": "", "revenue": 24623469.23}, {"supplier": "", "category": "", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_sql_complex_join_sales_margin", "final_answer": [{"product": "Côte de Blaye", "supplier": "", "margin": 0.0}, {"product": "Thüringer Rostbratwurst", "supplier": "", "margin": 0.0}, {"product": "Mishi Kobe Niku", "supplier": "", "margin": 0.0}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_monthly_revenue_trend", "final_answer": [{"month": "", "revenue": 0.0}], "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' AND o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_sql_category_supplier_pairs", "final_answer": [{"category": "", "supplier": "", "revenue": 53265895.23}, {"category": "", "supplier": "", "revenue": 24623469.23}, {"category": "", "supplier": "", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_aov_summer_beverages_1997", "final_answer": 28718.15, "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30';", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Order Details", "Orders", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_revenue_beverages_custom_range", "final_answer": 1997.0, "sql": "", "confidence": 0.6, "explanation": "Computed scalar value from 0 database rows.", "citations": ["marketing_calendar::chunk1", "catalog::chunk0", "product_policy::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_hybrid_top_category_qty_marketing_span", "final_answer": {"category": "Confections", "quantity": 229721}, "sql": "SELECT c.CategoryName as category, SUM(od.Quantity) as quantity FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE o.OrderDate BETWEEN '2013-01-01' AND '2013-12-31' GROUP BY c.CategoryID ORDER BY quantity DESC LIMIT 1;", "confidence": 0.99, "explanation": "Retrieved object with fields: category, quantity.", "citations": ["Categories", "Order Details", "Orders", "Products", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_aov_dec_winter_1997", "final_answer": 21032.34, "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2017-12-01' AND '2017-12-31';", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Order Details", "Orders", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_best_customer_margin_range", "final_answer": {"customer": "Great Lakes Food Market", "margin": 238454.4}, "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '2013' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.99, "explanation": "Retrieved object with fields: customer, margin.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_revenue_condiments_summer", "final_answer": 590780.5, "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' AND o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30';", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_top_suppliers_beverages_summer", "final_answer": {"supplier": "", "revenue": 53265895.23}, "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Retrieved object with fields: supplier, revenue.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "product_policy::chunk0"]}
{"id": "train_hybrid_custom_aov_date_range", "final_answer": 1997.0, "sql": "", "confidence": 0.6, "explanation": "Computed scalar value from 0 database rows.", "citations": ["marketing_calendar::chunk2", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk1"]}
{"id": "train_hybrid_category_margin_comparison", "final_answer": {"category": "", "margin": 0.0}, "sql": "", "confidence": 0.5, "explanation": "Retrieved object with fields: category, margin.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1"]}
{"id": "train_hybrid_best_customers_by_orders_and_margin", "final_answer": [{"customer": "Great Lakes Food Market", "margin": 238454.4, "orders": 0}], "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '2013' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Customers", "Order Details", "Orders", "kpi_definitions::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_revenue_produce_custom_range", "final_answer": 1997.0, "sql": "", "confidence": 0.6, "explanation": "Computed scalar value from 0 database rows.", "citations": ["marketing_calendar::chunk1", "catalog::chunk0", "product_policy::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_hybrid_aov_weekend_vs_weekday", "final_answer": [], "sql": "", "confidence": 0.3, "explanation": "Extracted 0 results from database.", "citations": ["kpi_definitions::chunk0", "kpi_definitions::chunk1", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_category_trend_multi_month", "final_answer": [{"month": "", "revenue": 0.0}], "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' AND o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk2", "product_policy::chunk0"]}
{"id": "train_hybrid_customers_repeat_rate", "final_answer": 1.0, "sql": "", "confidence": 0.6, "explanation": "Computed scalar value from 0 database rows.", "citations": ["kpi_definitions::chunk0", "catalog::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_top_products_by_margin_period", "final_answer": [{"product": "", "margin": 238454.4}], "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '2013' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_supplier_delays_marketing_period", "final_answer": [], "sql": "", "confidence": 0.3, "explanation": "Extracted 0 results from database.", "citations": ["marketing_calendar::chunk0", "product_policy::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2", "catalog::chunk0"]}
{"id": "train_hybrid_multi_table_having", "final_answer": [{"supplier": "", "category": "", "revenue": 0.0}], "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' AND o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_complex_order_filters", "final_answer": [{"customer": "", "total": 0.0}], "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk2", "product_policy::chunk0"]}
{"id": "train_hybrid_return_policy_overlap", "final_answer": "﻿# Northwind Marketing Calendar (1997) ﻿# Catalog Snapshot\n- Categories include Beverages, Condiments, Confections, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, Seafood.\n- Products map to categories as in the Northwind DB. ## Winter Classics 1997\n- Dates: 1997-12-01 to 1997-12-31\n- Notes: Push Dairy Products and Confections for holiday gifting. ﻿# KPI Definitions\n## Average Order Value (AOV) ## Gross Margin\n- GM = SUM((UnitPrice - CostOfGoods) * Quantity * (1 - Discount))\n- If cost is ", "sql": "", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["marketing_calendar::chunk0", "catalog::chunk0", "marketing_calendar::chunk2", "kpi_definitions::chunk0", "kpi_definitions::chunk2"]}
{"id": "train_hybrid_category_cross_sell_pairs", "final_answer": [], "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '1997' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_promotional_aov_increase", "final_answer": [{"aov": 28718.15}], "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30';", "confidence": 0.99, "explanation": "Extracted 1 results from database.", "citations": ["Order Details", "Orders", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "train_hybrid_supplier_category_margin_breakdown", "final_answer": [], "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '1997' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_high_value_orders_list", "final_answer": [], "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '1997' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.6, "explanation": "Extracted 0 results from database.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_category_seasonal_volatility", "final_answer": 92163184.18, "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' ;", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_top_customers_ltv_segment", "final_answer": 53265895.23, "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Computed scalar value from 3 database rows.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0"]}
{"id": "train_hybrid_product_return_impact_on_revenue", "final_answer": 53265895.23, "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Computed scalar value from 3 database rows.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
