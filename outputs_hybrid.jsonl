{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "", "confidence": 0.6, "explanation": "Computed scalar value from 0 database rows.", "citations": ["product_policy::chunk0", "catalog::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2", "kpi_definitions::chunk2"]}
{"id": "hybrid_top_category_qty_summer_1997", "final_answer": {"category": "Confections", "quantity": 17372}, "sql": "SELECT c.CategoryName as category, SUM(od.Quantity) as quantity FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30' GROUP BY c.CategoryID ORDER BY quantity DESC LIMIT 1;", "confidence": 0.99, "explanation": "Retrieved object with fields: category, quantity.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1"]}
{"id": "hybrid_aov_winter_1997", "final_answer": 21032.34, "sql": "SELECT ROUND( SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) * 1.0 / NULLIF(COUNT(DISTINCT o.OrderID), 0), 2) as aov FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2017-12-01' AND '2017-12-31';", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "Côte de Blaye", "revenue": 53265895.23}, {"product": "Thüringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT p.ProductName as product, ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Products p ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY revenue DESC LIMIT 3;", "confidence": 0.99, "explanation": "Extracted 3 results from database.", "citations": ["Order Details", "Products", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk1", "kpi_definitions::chunk2", "marketing_calendar::chunk2"]}
{"id": "hybrid_revenue_beverages_summer_1997", "final_answer": 590780.5, "sql": "SELECT ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) as revenue FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Products p ON p.ProductID = od.ProductID JOIN Categories c ON c.CategoryID = p.CategoryID WHERE c.CategoryName = 'Beverages' AND o.OrderDate BETWEEN '2013-06-01' AND '2013-06-30';", "confidence": 0.99, "explanation": "Computed scalar value from 1 database rows.", "citations": ["Categories", "Order Details", "Orders", "Products", "catalog::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk0", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
{"id": "hybrid_best_customer_margin_1997", "final_answer": {"customer": "Great Lakes Food Market", "margin": 238454.4}, "sql": "SELECT cu.CompanyName as customer, ROUND(SUM((od.UnitPrice * (1 - 0.7)) * od.Quantity * (1 - od.Discount)), 2) as margin FROM [Order Details] od JOIN Orders o ON o.OrderID = od.OrderID JOIN Customers cu ON cu.CustomerID = o.CustomerID WHERE strftime('%Y', o.OrderDate) = '2013' GROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1;", "confidence": 0.99, "explanation": "Retrieved object with fields: customer, margin.", "citations": ["Customers", "Order Details", "Orders", "catalog::chunk0", "kpi_definitions::chunk0", "kpi_definitions::chunk2", "marketing_calendar::chunk1", "marketing_calendar::chunk2"]}
